<?xml version="1.0"?>
<clickhouse>
    <!-- Enable automatic cluster discovery. -->
        <!-- Swarm cluster built using remote discovery --> 
        <swarm>
            <discovery>
                <path>/clickhouse/discovery/swarm</path>
                <secret>secret_key</secret>
            </discovery>
        </swarm>
        <!-- Cluster containing all servers to enable query across every replica -->
        <all>
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>clickhouse1</host>
                    <port>9000</port>
                </replica>
            </shard>
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>clickhouse2</host>
                    <port>9000</port>
                </replica>
            </shard>
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>clickhouse3</host>
                    <port>9000</port>
                </replica>
            </shard>
        </all>
    <allow_experimental_cluster_discovery>1</allow_experimental_cluster_discovery>
    <remote_servers>
        <replicated_cluster>
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>clickhouse1</host>
                    <port>9000</port>
                </replica>
                <replica>
                    <host>clickhouse2</host>
                    <port>9000</port>
                </replica>
                <replica>
                    <host>clickhouse3</host>
                    <port>9000</port>
                </replica>
            </shard>
        </replicated_cluster>
        <!--
        <replicated_cluster_readonly>
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>clickhouse1</host>
                    <port>9000</port>
                    <user>readonly</user>
                </replica>
                <replica>
                    <host>clickhouse2</host>
                    <port>9000</port>
                    <user>readonly</user>
                </replica>
                <replica>
                    <host>clickhouse3</host>
                    <port>9000</port>
                    <user>readonly</user>
                </replica>
            </shard>
        </replicated_cluster_readonly>
        -->
        <replicated_cluster_secure>
            <shard>
                <internal_replication>true</internal_replication>
                <replica>
                    <host>clickhouse1</host>
                    <port>9440</port>
                    <secure>1</secure>
                </replica>
                <replica>
                    <host>clickhouse2</host>
                    <port>9440</port>
                    <secure>1</secure>
                </replica>
                <replica>
                    <host>clickhouse3</host>
                    <port>9440</port>
                    <secure>1</secure>
                </replica>
            </shard>
        </replicated_cluster_secure>
        <sharded_cluster>
            <shard>
                <replica>
                    <host>clickhouse1</host>
                    <port>9000</port>
                </replica>
            </shard>
            <shard>
                <replica>
                    <host>clickhouse2</host>
                    <port>9000</port>
                </replica>
            </shard>
            <shard>
                <replica>
                    <host>clickhouse3</host>
                    <port>9000</port>
                </replica>
            </shard>
        </sharded_cluster>
        <sharded_cluster_secure>
            <shard>
                <replica>
                    <host>clickhouse1</host>
                    <port>9440</port>
                    <secure>1</secure>
                </replica>
            </shard>
            <shard>
                <replica>
                    <host>clickhouse2</host>
                    <port>9440</port>
                    <secure>1</secure>
                </replica>
            </shard>
            <shard>
                <replica>
                    <host>clickhouse3</host>
                    <port>9440</port>
                    <secure>1</secure>
                </replica>
            </shard>
        </sharded_cluster_secure>
    </remote_servers>
</clickhouse>
