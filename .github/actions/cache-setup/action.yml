name: 'Cache setup'
description: 'Cache setup'

runs:
  using: 'composite'
  steps:
    - name: "Mounted volumes"
      shell: bash
      run: |
         if [ -f "/etc/hetzner-volumes" ]; then
             echo "Hetzner volumes"
             cat /etc/hetzner-volumes
         fi
    - name: Setup Python cache
      shell: bash
      run: |
        if [ -d "/mnt/cache" ]; then
            PYTHON_CACHE_DIR="/mnt/cache/python3.12-venv"
            mkdir -p "$PYTHON_CACHE_DIR" "$PWD/venv"
            sudo mount --bind "$PYTHON_CACHE_DIR" "$PWD/venv"
            echo "Using Python cached venv directory: $PYTHON_CACHE_DIR"
        else
            PYTHON_CACHE_DIR=""
            echo "No Python venv cache directory available, proceeding without caching"
        fi
